function [Jacob_sparse_ordered, ordering, original] = Sparse_reordering(Jacob_sparse, Scheme)
    %Jacob_sparse = [1,32.7276435866634,1,1,2,5;2,-5.04701746352268,1,2,3,6;3,-5.34605105053633,1,3,4,7;4,-5.42765413087835,1,4,76,11;5,-5.04701746352268,2,1,6,8;6,10.1665226108925,2,2,7,9;7,-5.11950514736986,2,3,78,10;8,-5.34605105053633,3,1,9,14;9,-5.11950514736986,3,2,10,51;10,38.7891223977310,3,3,11,15;11,-21.5785539816916,3,4,12,16;12,-4.88951266031734,3,6,13,24;13,-1.85549955781590,3,8,79,26;14,-5.42765413087835,4,1,15,50;15,-21.5785539816916,4,3,16,23;16,36.0507573245660,4,4,17,18;17,-4.55546650872112,4,5,81,19;18,-4.55546650872112,5,4,19,53;19,18.8643558292065,5,5,20,37;20,-4.38065954833727,5,10,21,36;21,-3.39828144258146,5,11,22,41;22,-6.52994832956663,5,12,83,42;23,-4.88951266031734,6,3,24,29;24,20.1675034129966,6,6,25,27;25,-6.18790803292648,6,7,26,28;26,-9.09008271975275,6,8,0,31;27,-6.18790803292648,7,6,28,30;28,6.18790803292648,7,7,0,0;29,-1.85549955781590,8,3,30,52;30,-9.09008271975275,8,6,31,0;31,24.3400268615602,8,8,32,34;32,-10.3653941270609,8,9,33,35;33,-3.02905045693060,8,13,86,46;34,-10.3653941270609,9,8,35,47;35,14.7683378765214,9,9,36,38;36,-4.40294374946052,9,10,89,39;37,-4.38065954833727,10,5,38,40;38,-4.40294374946052,10,9,39,58;39,8.78360329779779,10,10,92,62;40,-3.39828144258146,11,5,41,43;41,5.65025606875367,11,11,42,44;42,-2.25197462617221,11,12,94,45;43,-6.52994832956663,12,5,44,63;44,-2.25197462617221,12,11,45,67;45,11.0968864308442,12,12,46,48;46,-2.31496347510535,12,13,96,49;47,-3.02905045693060,13,8,48,57;48,-2.31496347510535,13,12,49,68;49,5.34401393203596,13,13,99,59;50,1.76190464239262,14,1,51,54;51,2.00583546702482,14,2,52,0;52,-10.6087207709131,14,3,53,55;53,6.84098066149567,14,4,102,56;54,1.77769095211365,15,1,55,0;55,6.84098066149567,15,3,56,0;56,-9.70612291587772,15,4,106,0;57,-5.32605503946736,17,8,58,60;58,3.90204955244743,17,9,59,61;59,1.42400548701993,17,13,111,72;60,3.90204955244743,18,8,61,73;61,-5.78293430614783,18,9,62,64;62,1.88088475370040,18,10,116,65;63,2.09188056259967,19,5,64,66;64,1.88088475370040,19,9,65,0;65,-3.97276531630007,19,10,119,0;66,1.63278516128254,20,5,67,69;67,-4.12180974810446,20,11,68,70;68,2.48902458682192,20,12,121,71;69,3.31585232210665,21,5,70,0;70,2.48902458682192,21,11,71,0;71,-6.94187106673489,21,12,72,74;72,1.13699415780633,21,13,123,75;73,1.42400548701993,22,8,74,0;74,1.13699415780633,22,12,75,0;75,-2.56099964482626,22,13,126,0;76,-1.76190464239262,1,14,77,78;77,-1.77769095211365,1,15,0,80;78,-2.00583546702482,2,14,0,79;79,10.4172582731592,3,14,80,81;80,-6.84098066149567,3,15,0,82;81,-6.84098066149567,4,14,82,102;82,9.42991265124281,4,15,0,103;83,-2.09188056259967,5,19,84,91;84,-1.63278516128254,5,20,85,94;85,-3.31585232210665,5,21,0,95;86,5.32605503946736,8,17,87,89;87,-3.90204955244743,8,18,88,90;88,-1.42400548701993,8,22,0,98;89,-3.90204955244743,9,17,90,99;90,5.78293430614783,9,18,91,92;91,-1.88088475370040,9,19,0,93;92,-1.88088475370040,10,18,93,114;93,3.69906131745525,10,19,0,118;94,3.90817430644132,11,20,95,96;95,-2.48902458682192,11,21,0,97;96,-2.48902458682192,12,20,97,121;97,6.50802123019757,12,21,98,100;98,-1.13699415780633,12,22,0,101;99,-1.42400548701993,13,17,100,105;100,-1.13699415780633,13,21,101,122;101,2.56099964482626,13,22,0,115;102,38.5192200174846,14,14,103,106;103,-21.5785539816916,14,15,104,107;104,-4.88951266031734,14,16,105,109;105,-1.85549955781590,14,17,0,110;106,-21.5785539816916,15,14,107,108;107,35.0165215875237,15,15,0,0;108,-4.88951266031734,16,14,109,111;109,18.9305084835327,16,16,110,112;110,-9.09008271975275,16,17,0,113;111,-1.85549955781590,17,14,112,0;112,-9.09008271975275,17,16,113,0;113,23.8449858889756,17,17,114,116;114,-10.3653941270609,17,18,115,117;115,-3.02905045693060,17,22,0,125;116,-10.3653941270609,18,17,117,126;117,14.7683378765214,18,18,118,119;118,-4.40294374946052,18,19,0,120;119,-4.40294374946052,19,18,120,0;120,8.21043288960413,19,19,0,0;121,5.20562111364955,20,20,122,123;122,-2.25197462617221,20,21,0,124;123,-2.25197462617221,21,20,124,0;124,10.2425006680972,21,21,125,127;125,-2.31496347510535,21,22,0,128;126,-3.02905045693060,22,17,127,0;127,-2.31496347510535,22,21,128,0;128,5.34401393203596,22,22,0,0];
    N_Jacobian = max(Jacob_sparse(:,3));
    
    switch Scheme
        case 0
            degree=zeros(1,N_Jacobian);
            for i=1:N_Jacobian
                for j=1:N_Jacobian
                    degree(i)=degree(i)+(sparse_table.retrieve(Jacob_sparse,i,j)~=0);
                end
            end
            ordering = (sortrows([(1:N_Jacobian)',degree'],2));
            ordering = ordering(:,1);

            [Jacob_sparse_ordered,JB]=sparse_table.Blank_array();
            for i=1:max(Jacob_sparse(:,3))
                for j=1:max(Jacob_sparse(:,3))
                    [Jacob_sparse_ordered,JB]=sparse_table.store(Jacob_sparse_ordered,JB,sparse_table.retrieve(Jacob_sparse,ordering(i),ordering(j)),i,j);
                end
            end
            original=((sortrows([(1:length(ordering))',ordering],2))*[1;0])';
    end
end